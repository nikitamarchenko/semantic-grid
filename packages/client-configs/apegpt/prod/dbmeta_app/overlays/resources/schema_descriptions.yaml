version: 1.0.0
description: Description of the database containing Solana blockchain data.
profiles:
  wh:
    whitelist: false
    tables:
      account_token_balance:
        hidden: true
        description: |
          Contains history of account token balances. Is linked to **token_balance_change** table
          via **balance_change_id** foreign key.
        columns:
          id:
            description: "Unique identifier for the record. Used as a primary key for joining with other tables."
          raw_tx:
            description: "Raw transaction data. DON'T USE THIS FIELD FOR ANYTHING."
            hidden: true
          balance_change_id:
            description: "Foreign key to **id** column or **token_balance_change** table. Used for joins"
          owner_account:
            description: "Solana account address (pubkey) of Token owner"
          token:
            description: "SPL Token Address, or Token Mint Address, a unique address of the Token generated by Solana SPL Program."
            example: "mb1eu7TzEc71KxDpsmsKoucSSuuoGLv1drys1oP2jh6 is the address of MOBILE Token Mint"
          balance:
            description: "Amount of tokens account owns since timestamp denoted by **ts** column."
          ts:
            description: "Timestamp when account balance change happened"
          slot:
            description: "Solana slot number for the balance change. DON'T USE THIS FIELD FOR ANYTHING."
            hidden: true

      token_balance_change:
        hidden: true
        description: |
          Contains history of solana account balance changes.
          Usually when users request information for account it means Solana address (**owner** column).
        columns:
          id:
            description: "Unique identifier for a record. Used as a primary key for joining with other tables."
          raw_tx:
            description: "Raw transaction data. DON'T USE THIS FIELD FOR ANYTHING."
            hidden: true
          owner:
            description: "Solana address (pubkey) of the owner of the Token."
            example: "DMAxEjg3AQ3x9twpmAhCBig6XC1gfjbEjCc894zqgJCc is a Solana address (pubkey)"
          account:
            description: |
              Program Derived Address (PDA) of the Token (Token Account) unique to the combination of the Token Mint Address
              and the User (Owner) Address.
            example: "Address DMAxEjg3AQ3x9twpmAhCBig6XC1gfjbEjCc894zqgJCc is the owner of ESczc2KfKpFANmPtxXEGa2n7cdBfjB6uvQYiKyt7xgxy Token Account"
          token:
            description: "SPL Token Address (Token Mint Address, unique address of the Token generated by Solana SPL Program)."
            example: "mb1eu7TzEc71KxDpsmsKoucSSuuoGLv1drys1oP2jh6 is the address of MOBILE Token Mint"
          balance_before:
            description: |
              Account balance (how many Tokens owner account has) before the transaction.
              Typical precision is 9 decimal places.
          balance_after:
            description: |
              Account balance (how many Tokens owner account has) after the transaction.
              Typical precision is 9 decimal places."
          change:
            description: "Account balance change as a result of the transaction."
          ts:
            description: "Timestamp of token balance change"
          slot:
            description: "Solana slot number for the transaction. DON'T USE THIS FIELD FOR ANYTHING."
            hidden: true

      token_instruction:
        hidden: true
        description: "Contains parsed instructions of transaction."
        columns:
          id:
            description: "Unique identifier for the record. Used as a primary key for joining with other tables."
          raw_tx:
            description: "Raw transaction data. DON'T USE THIS FIELD FOR ANYTHING."
            hidden: true
          instruction_type:
            description: |
              Type of the instruction, one of the following: Transfer, MintTo, Burn, TransferChecked, MintToChecked,
              BurnChecked, - corresponding to Solana SPL token program instructions.
              Transfer and TransferChecked - instructions to transfer token from **src** address to **dst** address.
              MintTo and MintToChecked - instruction to Mint Token for **src** Token Address,
                increasing the Token balance by **amount**.
              Burn and BurnChecked - instructions to Burn Token from **src** Token Address,
                decreasing the Token balance by **amount**.
          src:
            description: "Program Derived Token Address of the instruction source, owned by the **src_owner**."
          src_owner:
            description: "Solana address (pubkey) of the owner of the instruction source Token Account (**src**)."
            example: "Address DMAxEjg3AQ3x9twpmAhCBig6XC1gfjbEjCc894zqgJCc is the owner of ESczc2KfKpFANmPtxXEGa2n7cdBfjB6uvQYiKyt7xgxy Token Account"
          dst:
            description: "Program Derived Token Address of the instruction destination, owned by the **dst_owner**."
          dst_owner:
            description: "Solana address (pubkey) of the owner of the instruction destination Token Account (**dst**)."
            example: "Address DMAxEjg3AQ3x9twpmAhCBig6XC1gfjbEjCc894zqgJCc is the owner of ESczc2KfKpFANmPtxXEGa2n7cdBfjB6uvQYiKyt7xgxy Token Account"
          amount:
            description: "Amount of instruction, in the smallest unit of the Token. Typical precision is 9 decimal places."
          token:
            description: "SPL Token Address (Token Mint Address, unique address of the Token generated by Solana SPL Program)."
            example: "mb1eu7TzEc71KxDpsmsKoucSSuuoGLv1drys1oP2jh6 is the address of MOBILE Token Mint"
          stack_height:
            description: "DON'T USE THIS FIELD FOR ANYTHING."
            hidden: true
          ts:
            description: "Timestamp of instruction."
          slot:
            description: "Solana slot number for the transaction. DON'T USE THIS FIELD FOR ANYTHING."
            hidden: true

      # new_wh and wh_v2
      token_balance_opt:
        hidden: true
      account_balance_opt:
        hidden: true
      token_balance:
        description: |
          Contains history of Token balance changes in accounts. Each row represents a balance update triggered by
          an instruction, capturing both the previous and new balance states. Table is partitioned by **day** column.
        columns:
          slot:
            description: |
              Solana slot number when account balance changed.
              Use (ts, slot, synthetic_index) tuple for deterministic ordering.
          ts:
            description: |
              Timestamp of the balance change (without a timezone).
              Use (ts, slot, synthetic_index) tuple for deterministic ordering.
          day:
            hidden: true
            description: UTC date of the balance change (in YYYYMMDD format).
          signature:
            description: Transaction signature associated with the balance change.
          index_in_block:
            description: Index of the instruction within the block.
          account_pubkey:
            description: Solana address (public key) of the Token Account holding Token.
            hidden: true
          owner:
            description: Solana address of Token owner (usually a wallet).
          token_account:
            description: Program Derived Token Address (PDA) of the Associated Token Account or Token Account.
            hidden: true
          token_mint:
            description: SPL token address, or Token Mint Address, a unique address of the Token in Solana.
            example: mb1eu7TzEc71KxDpsmsKoucSSuuoGLv1drys1oP2jh6 is the address of MOBILE token.
          program_id:
            description: Address of the Solana program associated with this token.
            hidden: true
          pre_balance:
            description: Balance before the change (in the smallest token units).
          post_balance:
            description: Balance after the change (in the smallest token units).
          pre_decimals:
            hidden: true
            description: Number of decimal places in pre_balance.
          post_decimals:
            hidden: true
            description: Number of decimal places in post_balance.
          decimals:
            description: Number of decimal places in the token mint.
          pre_balance_ui:
            hidden: true
            description: Balance before the change, formatted for UI (pre_balance / 10^pre_decimals).
          post_balance_ui:
            hidden: true
            description: Balance after the change, formatted for UI (post_balance / 10^post_decimals).
          pre_balance_calculated:
            description: Human-readable format of the pre_balance (with decimal point set).
          post_balance_calculated:
            description: Human-readable format of the post_balance (with decimal point set).
          change:
            description: Difference between post_balance and pre_balance (in the smallest token units).
          change_ui:
            hidden: true
            description: Difference in UI format (balance change / 10^post_decimals).
          change_calculated:
            description: Human-readable format of the balance change (with decimal point set).
          is_snapshot:
            description: Flag indicating if the balance is a snapshot (TRUE) or a change (FALSE).
            example: TRUE — snapshot, FALSE — change.
          is_valid:
            hidden: true
            description: Data validity flag
            example: TRUE — valid data, FALSE — possible errors, rejected.
          synthetic_index:
            description: |
              Synthetic index for ordering the data. Use (ts, slot, synthetic_index) tuple for deterministic ordering.
          rate_to_usdc:
            description: Rate of the token in USD at the time of the balance change.
          pre_balance_in_usdc:
            description: Pre-balance in USD (pre_balance * rate_to_usdc).
          post_balance_in_usdc:
            description: Post-balance in USD (post_balance * rate_to_usdc).
          change_in_usdc:
            description: Change in balance in USD (post_balance_in_usdc - pre_balance_in_usdc).

      instruction:
        hidden: true
        description: |
          Contains parsed Instructions of Transactions.
          Use this table to look for token transfers, mints, burns, similar atomic operations.
          (use **instruction_type** column to filter for specific types of instructions).
        columns:
          slot:
            description: Slot number in the Solana blockchain. Use (ts, slot, index) tuple for deterministic ordering.
          ts:
            description: Timestamp of the transaction (without timezone). Use (ts, slot, index) tuple for deterministic ordering.
          day:
            hidden: true
            description: Transaction date in YYYYMMDD format.
          signature:
            description: Transaction signature, a unique identifier. Linked to the **Transaction** table.
          instruction_type:
            description: |
              Type of instruction; most common types are:
                - Transfer
                - TransferChecked
                - MintTo
                - MintToChecked
                - Burn
                - BurnChecked
          amount:
            description: Amount of tokens transferred in the transaction.
          decimals:
            description: Number of decimal places for the token.
          calculated_amount:
            description: Human-readable format of the transferred amount.
          account_owner:
            description: Owner of the account associated with the instruction. Used in burn instructions.
          account_mint:
            description: Token mint associated with the account. Used in burn instructions.
          mint:
            description: Token account of the minted, burned or transferred token.
          destination_owner:
            description: Solana address of the owner of the token transfer instruction destination.
            example: DMAxEjg3AQ3x9twpmAhCBig6XC1gfjbEjCc894zqgJCc
          destination_mint:
            description: Token associated with the recipient account for transfer and transferChecked instruction.
          source_owner:
            description: Solana address of the owner of the token transfer instruction source.
            example: DMAxEjg3AQ3x9twpmAhCBig6XC1gfjbEjCc894zqgJCc
          source_mint:
            description: Token associated with the sender account for transfer and transferChecked instruction.
          is_valid:
            description: Data validity flag (TRUE — valid data, FALSE — possible errors, rejected).
          synthetic_index:
            description: Synthetic index for ordering the data. Use (ts, slot, synthetic_index) tuple for deterministic ordering.

          # hidden fields
          index_in_block:
            description: Index of the instruction within the block.
            hidden: true
          program:
            description: Name of the program executing the transaction.
            hidden: true
          program_id:
            description: Address of the Solana program associated with this token.
            hidden: true
          data:
            description: Raw instruction data as a string.
            hidden: true
          parsed:
            description: Parsed transaction data in JSON format.
            hidden: true
          account:
            description: |
              Address of the account associated with the transaction.
              Only used for createAccount and closeAccount instructions.
            hidden: true
          accounts:
            description: List of accounts involved in the transaction.
            hidden: true
          stack_height:
            description: Call stack height of the instruction execution.
            hidden: true
          mint_authority:
            description: Address of the mint authority.
            hidden: true
          multisig:
            description: Address of a multisig account (if applicable).
            hidden: true
          multisig_mint_authority:
            description: Mint authority for a multisig account.
            hidden: true
          multisig_authority:
            description: Authority managing the multisig account.
            hidden: true
          multisig_freeze_authority:
            description: Address with freeze authority over a multisig account.
            hidden: true
          authority:
            description: Address of the current transaction authority.
            hidden: true
          authority_type:
            description: Type of authority permissions.
            hidden: true
          new_authority:
            description: New authority after an ownership change.
            hidden: true
          delegate:
            description: Delegate address with permissions over the account.
            hidden: true
          multisig_owner:
            description: Owner of the multisig account.
            hidden: true
          freeze_authority:
            description: Address with freeze authority over the account.
            hidden: true
          rent_sysvar:
            description: System variable related to account rent.
            hidden: true
          signers:
            description: List of accounts that signed the transaction.
          signers_m:
            description: Number of required signatures for a multisig transaction.
            hidden: true
          extension_types:
            description: List of transaction extensions (if any).
            hidden: true
          native_mint:
            description: Native token account.
            hidden: true
          system_program:
            description: Address of the Solana system program.
            hidden: true
          token_program:
            description: Address of the Solana token program.
            hidden: true
          ui_amount:
            description: Human-readable format of the transferred amount.
            hidden: true
          nested_source:
            description: Nested source of the transaction (if applicable).
            hidden: true
          nested_mint:
            description: Nested token account (if applicable).
            hidden: true
          nested_owner:
            description: Owner of the nested account.
            hidden: true
          owner_mint:
            description: Owner of the token mint account.
            hidden: true
          index:
            description: Index of the instruction within the block.
            hidden: true
          inner_index:
            description: Index of an inner instruction.
            hidden: true
          outer_index:
            description: Index of an outer instruction.
            hidden: true
          dst_account:
            description: Recipient account address.
            hidden: true
          src_account:
            description: Sender account address.
            hidden: true
          wallet:
            description: Wallet participating in the transaction.
            hidden: true
          payer:
            description: Payer of the transaction fee.
          destination:
            description: Program Derived Token Address of the instruction destination.
            example: ESczc2KfKpFANmPtxXEGa2n7cdBfjB6uvQYiKyt7xgxy
            hidden: true
          source:
            description: Program Derived Token Address of the instruction source.
            example: ESczc2KfKpFANmPtxXEGa2n7cdBfjB6uvQYiKyt7xgxy
            hidden: true
          owner:
            description: Owner of the account.
            hidden: true

      transaction:
        hidden: true
        description: |
          contains blockchain transaction data, including block information, signatures, accounts, execution costs,
          and transaction status. On Solana blockchain, a transaction is a collection of instructions.
          This table doesn't mean to be used directly.
        columns:
          slot:
            description: Slot number in the Solana blockchain (a slot is a logical time interval in the blockchain).
            hidden: true
          hash:
            description: Unique transaction hash, serving as the transaction identifier in the blockchain.
            hidden: true
          prev_hash:
            description: Hash of the previous block, used to link blocks together.
            hidden: true
          ts:
            description: Timestamp of the transaction (when it was recorded in the block).
          day:
            hidden: true
            description: The day the transaction occurred (in YYYYMMDD format).
          signature:
            description: Transaction signature, a unique identifier.
          index_in_block:
            description: Index of the transaction within the block.
          signatures:
            description: List of signatures that validated the transaction.
            hidden: true
          recent_blockhash:
            description: Hash of the most recent block referenced by the transaction.
            hidden: true
          err:
            description: Error message if the transaction failed.
            hidden: true
          accounts:
            description: List of accounts involved in the transaction.
          writable_accounts:
            description: List of accounts that can be modified within the transaction.
          signers_accounts:
            description: Accounts that signed the transaction.
          logs:
            description: Event logs generated during transaction execution.
            hidden: true
          fee:
            description: Transaction execution fee.
          compute_units_consumed:
            description: Number of compute units used for transaction execution.
          return_program_id:
            description: Identifier of the program that returned the execution result.
          return_data:
            description: Data returned by the program during execution.
            hidden: true
          is_valid:
            description: Transaction success flag.
            example: true – successful, false – failed.

      account_balance:
        hidden: true
        description: |
          contains balance changes for Solana accounts on the blockchain. Each
          row represents a balance update triggered by an instruction, capturing both the
          previous and new balance states. The data is partitioned by **day** column for efficient
          querying.
        columns:
          slot:
            description: |
              Slot number in which the balance change occurred (a slot is a logical time interval in the blockchain).
              Use (ts, slot, synthetic_index) tuple for deterministic ordering.
          ts:
            description: |
              Timestamp when the balance change was recorded.
              Use (ts, slot, synthetic_index) tuple for deterministic ordering.
          day:
            hidden: true
            description: The day when the balance change occurred (in YYYYMMDD format).
          signature:
            description: Transaction signature, a unique identifier.
          index_in_block:
            description: Index of the transaction within the block.
          account:
            description: Blockchain address of the account whose balance changed.
          pre_balance:
            description: Account balance before the transaction execution (recorded as a high-precision decimal).
          post_balance:
            description: Account balance after the transaction execution.
          change:
            description: Difference between post_balance and pre_balance, representing the net change in balance.
          is_valid:
            description: Flag indicating whether the transaction was successfully processed.
            example: true – successful, false – failed.
          synthetic_index:
            description: Synthetic index for ordering the data. Use (ts, slot, synthetic_index) tuple for deterministic ordering.

      tickers:
        hidden: true
        description: |
          Contains information about tokens and their mint addresses. This table is used to
          identify the token mint address corresponding to a specific ticker symbol (ticker).
          Join this table with other tables to convert mint address to a meaningful ticker (symbol) name.
        address:
          description: Address of the token mint, corresponding to the ticker (symbol).
          example: mb1eu7TzEc71KxDpsmsKoucSSuuoGLv1drys1oP2jh6 is the address of MOBILE token mint.
        symbol:
          description: Ticker symbol of the token, used for easy identification.

      dex:
        hidden: true
        description: |
          Contains information about decentralized exchange (DEX) transactions on the Solana blockchain.
          Use this table to look for token swaps (trades).

      ##
      ## CREATE TABLE ct.trades
      #(
      #    `slot` Int64,
      #    `ts` DateTime64(6),
      #    `signature` Nullable(String),
      #    `index_in_block` Nullable(Int32),
      #    `signers` Array(Nullable(String)),
      #    `program_id` Nullable(String),
      #    `dex` Nullable(String),
      #    `dex_name` Nullable(String),
      #    `dex_order_in_tx` Nullable(Int64),
      #    `source_mint` Nullable(String),
      #    `destination_mint` Nullable(String),
      #    `source_amount` Nullable(Decimal(38, 18)),
      #    `destination_amount` Nullable(Decimal(38, 18)),
      #    `source_account` Nullable(String),
      #    `destination_account` Nullable(String),
      #    `source_account_owner` String,
      #    `destination_account_owner` String,
      #    `source_decimals` Nullable(Int16),
      #    `destination_decimals` Nullable(Int16),
      #    `source_calculated_amount` Nullable(Float64),
      #    `destination_calculated_amount` Nullable(Float64),
      #    `destination_ticker_verified` Nullable(Bool),
      #    `destination_ticker` Nullable(String),
      #    `destination_ticker_description` Nullable(String),
      #    `source_ticker` Nullable(String),
      #    `source_ticker_verified` Nullable(Bool),
      #    `source_ticker_description` Nullable(String),
      #    `destination_rate_to_udc` Nullable(Float64),
      #    `source_rate_to_udc` Nullable(Float64),
      #    `source_calculated_amount_in_usdc` Nullable(Float64),
      #    `destination_calculated_amount_in_usdc` Nullable(Float64),
      #    `day` Nullable(String)
      #)
      trades:
        description: |
          Contains information about decentralized exchange (DEX) transactions on the Solana blockchain.
          Use this table to look for token swaps (trades).
        columns:
            slot:
                description: Slot number in the Solana blockchain (a slot is a logical time interval in the blockchain).
            ts:
                description: Timestamp of the transaction (when it was recorded in the block).
            signature:
                description: Transaction signature, a unique identifier.
            index_in_block:
                description: Index of the transaction within the block.
            signers:
                description: List of accounts that signed the transaction.
            program_id:
                description: Address of the Solana program associated with this token.
            dex:
                description: Name of the decentralized exchange (DEX) where the trade occurred.
            dex_name:
                description: Human-readable name of the DEX.
            dex_order_in_tx:
                description: Order of the DEX operation within the transaction.
            source_mint:
                description: Token mint address for the source token in the trade.
            destination_mint:
                description: Token mint address for the destination token in the trade.
            source_amount:
                description: Amount of source tokens involved in the trade (in smallest units).
            destination_amount:
                description: Amount of destination tokens received from the trade (in smallest units).
            source_account:
                description: Program Derived Token Address (PDA) of the source token account.
            destination_account:
                description: Program Derived Token Address (PDA) of the destination token account.
            source_account_owner:
                description: Owner of the source token account.
            destination_account_owner:
                description: Owner of the destination token account.
            source_decimals:
                description: Number of decimal places for the source token amount.
            destination_decimals:
                description: Number of decimal places for the destination token amount.
            source_calculated_amount:
                description: Human-readable format of the source amount (source_amount / 10^source_decimals).
            destination_calculated_amount:
                description: Human-readable format of the destination amount (destination_amount / 10^destination_decimals).
            destination_ticker_verified:
                description: Flag indicating if destination ticker is verified.
            destination_ticker:
                description: Ticker symbol for the destination token, if available.
            destination_ticker_description:
                description: Description or additional information about the destination ticker.
            source_ticker:
                description: Ticker symbol for the source token, if available.
            source_ticker_verified:
                description: Flag indicating if source ticker is verified.
            source_ticker_description:
                description: Description or additional information about the source ticker.
            destination_rate_to_udc:
                description: Rate of the destination token in USD (USDC).
            source_rate_to_udc:
                description: Rate of the source token in USD (USDC).
            source_calculated_amount_in_usdc:
                description: Human-readable format of the source amount in USD (source_amount * source_rate_to_udc).
            destination_calculated_amount_in_usdc:
                description: Human-readable format of the destination amount in USD (destination_amount * destination_rate_to_udc).
            day:
                hidden: true
                description: The day when the trade occurred (in YYYYMMDD format).

      rates:
        hidden: true
        description: |
          Contains information about token rates (prices) in USD. Use this table to look for token prices.
        columns:
          mint:
            description: Token mint address, corresponding to the ticker (symbol).
          ts:
            description: Timestamp (datetime) corresponding to the rate.
          ticker:
            description: Ticker symbol of the token.
          rate_to_usdc:
            description: Rate of the token in USD.